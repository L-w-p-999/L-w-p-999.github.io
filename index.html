<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/22/useEffect%E9%92%A9%E5%AD%90-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/22/useEffect%E9%92%A9%E5%AD%90-1/" class="post-title-link" itemprop="url">useEffect钩子</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-04-22 12:46:50 / Modified: 12:47:10" itemprop="dateCreated datePublished" datetime="2025-04-22T12:46:50+08:00">2025-04-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h1><h2 id="1-1问题的发现"><a href="#1-1问题的发现" class="headerlink" title="1.1问题的发现"></a>1.1问题的发现</h2><p>事实上，第一次接触<code>useEffect</code>hook的时候，我并不非常清楚useEffect的机制是如何运行的，只知道它会让我的页面可以进行多样化的渲染操作。在写mini期间，我一直想实现一个很简单的功能，就是每次我点击我设置的底部导航栏并实现页面的跳转的时候，都可以实现页面的重渲染，这样我就可以让一个使用者在另一个页面进行了一个curd的同时，实时的将真实的数据反映到另一个页面。</p>
<p>我之所以非要去实现进入页面的时候一定是真实的用户数据而不是通过进行前端的操作去实现的暂时储存在前端的数据的理由是：我的页面逻辑会出现一定问题（my problems）。是的，因为mini写了一些屎山代码，如果我不去实现数据的实时更新就会出现一个功能的按键已经暴露出来了，但是这个按键没链接上后端。😫</p>
<h2 id="1-2硬生生去解决一下这个问题"><a href="#1-2硬生生去解决一下这个问题" class="headerlink" title="1.2硬生生去解决一下这个问题"></a>1.2硬生生去解决一下这个问题</h2><p>没办法，为了解决自己代码形成的问题，我只能去想个办法，把最新的实时数据获取过来，并让这发生在每一次进入页面的时候。于是，我开始使用<code>useEffect</code>来实现我想要的功能，然后就发现<code>useEffect</code>好像并没有按照我想要的功能去实现。此时我就发现我根本不了解<code>useEffect</code>这个钩子是在干什么，我只是在瞎用。<code>useEffect</code>的第二个参数在填写空数组的时候并不是实现我想要的进入页面就渲染一次，而是只在组件第一次进行挂载的时候或者组件被删除重新挂载的时候去执行渲染。</p>
<ol>
<li><p>传入[]时，通常只会在第一次组件渲染时进行作用。当然也有会再次触发的情况，比如组件卸载之后又进行了重新挂载，在严格模式下useEffect会执行两次以此来帮助发现副作用的问题。关于useEffect触发两次的情况，在我测试sass等等期间的时候也出现过两次useEffect获取数据两次的情况（</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">StrictMode</span>&gt;</span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"> &lt;/<span class="title class_">StrictMode</span>&gt;,</span><br></pre></td></tr></table></figure>

<p>这个地方的<code>StrictMode</code>就是使用了严格模式。其实我在写mini期间也出现了一个useEffect获取两遍数据的情况，但是现在我也不知道是为什么，整个项目检查以后我并没有看到什么很明显用来开启严格模式的语句词段，所以是why？🤯🤯🤯），除了以上三种会引发useEffect传入空数组情况下的作用，还有一种不太常见的触发空数组为依赖数组的uesEffect的情况就是改变这个组件的唯一标识符</p>
<p>。</p>
</li>
<li><p>不传入任何数组的时候，这个useEffect就会默认因为任何状态的改变去进行（）中的操作。1.当你放在这个导出组件的内部的任何一个useState改变的时候，useEffect都会发生作用。2.当使用useEffect的组件在被包裹在一个父组件中时，父组件重新渲染时，也会连带着触发它的子组件的useEffect进行作用。</p>
<p>好了，问题来了，下面这两个使用useEffect的例子在点击button时会不会触发useEffect里的作用呢？</p>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125;form <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ExampleChild</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;child&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="function">()=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line">    &#125;，[])</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>child<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ExampleParent</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> [show,setShow]=<span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;setShow(!show)&#125;&#125;&gt;Toggle Child<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;show&amp;&amp;<span class="tag">&lt;<span class="name">ExampleChild</span>&gt;</span><span class="tag">&lt;/<span class="name">ExampleChild</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Example</span>(<span class="params">&#123; id &#125;</span>) &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Component <span class="subst">$&#123;id&#125;</span> Mounted`</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Component &#123;id&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [id, setId] = <span class="title function_">useState</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setId(id + 1)&#125;&gt;Change Key<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Example</span> <span class="attr">key</span>=<span class="string">&#123;id&#125;/*去掉这里的key呢？*/</span> <span class="attr">id</span>=<span class="string">&#123;id&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后说说回如何每次进入这个页面的时候都会触发一次useEffect里的作用的方式：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useFocusEffect</span>(</span><br><span class="line">   <span class="title function_">useCallback</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (!isLogin) &#123;</span><br><span class="line">       <span class="title function_">alert</span>(<span class="string">&quot;请先登录&quot;</span>);</span><br><span class="line">       router.<span class="title function_">push</span>(<span class="string">&quot;../(tabsin)/login&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">const</span> <span class="title function_">loadInitialGroups</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">       <span class="keyword">const</span> initialGroups = <span class="keyword">await</span> <span class="title function_">getGroupfirst</span>(<span class="number">0</span>);</span><br><span class="line">       <span class="keyword">if</span> (!initialGroups) <span class="keyword">return</span>;</span><br><span class="line">       <span class="title function_">setGroups</span>(initialGroups);</span><br><span class="line">       <span class="title function_">setFilteredGroups</span>(initialGroups);</span><br><span class="line">     &#125;;</span><br><span class="line">     <span class="title function_">loadInitialGroups</span>();</span><br><span class="line">   &#125;, [isLogin])</span><br><span class="line"> );</span><br></pre></td></tr></table></figure>

<p>如上面代码显示的，使用useFoucsEffect这个钩子可以实现每次进入这个页面的时候都会触发一次他里面包含的回调函数，这个地方我尝试过把useCallback换成useEffect啊，但是发现报错了，VScode的报错原因看不懂就直接搜了，本质是因为react提供的钩子函数只能在函数组件和Hook的最顶层调用，不能在普通函数、条件语句或嵌套函数中调用。最常见的例子是你在useEffect里不能使用useState钩子。好了，这样我用来解决自己创造出来的问题的解决方式就说完了，但是useCallback相比useEffect究竟好在哪里呢？如果我们就要把useEffect放在useCallback的位置会怎么样呢？</p>
<h2 id="1-3useEffect和useCallback"><a href="#1-3useEffect和useCallback" class="headerlink" title="1.3useEffect和useCallback"></a>1.3useEffect和useCallback</h2><p>假设没有react导出的钩子只能在最顶层调用的规则，我们就硬要把useEffect放进这个useFoucsEffect里，会出现什么问题呢？</p>
<p>useCallback再上面那个代码块中起到了什么样子的作用呢？区别在于useCallback会阻止在每次渲染的时候重新创建新的函数实例从而避免因函数变化而导致的不必要的子组件重新渲染或者effect重新执行。而如果使用useEffect的话，虽然在传入依赖项不变的情况下，effect不会发生作用，但是实际上这个uesEffect在每次页面渲染变化的时候都会创建一个新的函数实例，只是在传入的依赖项不变化的时候，这个useEffect不会触发而已。而当useEffect每次都创建一个函数实例的同时，都会让useFoucsEffect重新执行回调，也就是相当于整个useFoucsEffect的作用失效了，没有起到每次页面聚焦的时候才会执行回调的效果。并且会出现很多的问题。</p>
<p>比如：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useFocusEffect &#125; <span class="keyword">from</span> <span class="string">&quot;@react-navigation/native&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyScreen</span>(<span class="params">&#123; isLogin, router, setData &#125;</span>) &#123;</span><br><span class="line">  <span class="title function_">useFocusEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLogin) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;请先登录&quot;</span>);</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&quot;../(tabsin)/login&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 错误示例：在 useFocusEffect 回调中嵌套调用 useEffect</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;内部 useEffect: 正在获取数据&quot;</span>);</span><br><span class="line">      <span class="keyword">const</span> <span class="title function_">fetchData</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/api/data&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">        <span class="title function_">setData</span>(data);</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="title function_">fetchData</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;内部 useEffect: 清理副作用&quot;</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;, []);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这段代码可能会因为注册的副作用没有被正确地清理而导致多个请求同时爆发引发数据不一致等问题。这个地方如果改成useCallback，并确定好依赖项，就能够确保在依赖项不改变的情况下函数实例不会重建。useCallback是一种用于优化性能的hook，实际上所有使用useCallback和另一个优化性能的hook<code>useMemo</code>的地方都可以通过别的方式实现他们的基本功能，只要不考虑性能的问题。但是在实际开发过程中这两个钩子的使用概率还是很大的。</p>
<h2 id="1-4useMemo"><a href="#1-4useMemo" class="headerlink" title="1.4useMemo"></a>1.4useMemo</h2><p>useMemo和useCallback本质上是一个东西，但是useMemo的返回值不是一个函数，而是一个数组或者对象或者复杂的计算结果。useMemo可以帮助我们在页面重新渲染的时候确保一些不需要渲染或者改变的地方不会再去重新执行，这里我摘抄一篇博客里的例子来说明：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> format <span class="keyword">from</span> <span class="string">&#x27;date-fns/format&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [selectedNum, setSelectedNum] = <span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="number">100</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// `time` 是一个状态变量，每秒钟变化一次，所以它总是与当前时间同步</span></span><br><span class="line">  <span class="keyword">const</span> time = <span class="title function_">useTime</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> allPrimes = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> counter = <span class="number">2</span>; counter &lt; selectedNum; counter++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isPrime</span>(counter)) &#123;</span><br><span class="line">      allPrimes.<span class="title function_">push</span>(counter);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;clock&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;format(time, &#x27;hh:mm:ss a&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;num&quot;</span>&gt;</span>Your number:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;number&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">value</span>=<span class="string">&#123;selectedNum&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;(event)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            // 为了防止电脑烧起来，我们限制一下传入的值最大为 100k</span></span><br><span class="line"><span class="language-xml">            let num = Math.min(100_000, Number(event.target.value));</span></span><br><span class="line"><span class="language-xml">            </span></span><br><span class="line"><span class="language-xml">            setSelectedNum(num);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        There are &#123;allPrimes.length&#125; prime(s) between 1 and &#123;selectedNum&#125;:</span></span><br><span class="line"><span class="language-xml">        &#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;prime-list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;allPrimes.join(&#x27;, &#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [time, setTime] = <span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">  </span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = <span class="variable language_">window</span>.<span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setTime</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(intervalId);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> time;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// isPrime 用于计算传入的参数是否为质数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrime</span>(<span class="params">n</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> max = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="title class_">Math</span>.<span class="title function_">sqrt</span>(n));</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> counter = <span class="number">2</span>; counter &lt;= max; counter++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n % counter === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里能看到一个计时器被启动了，也就是在这个页面上有个数字在不停地改变，整个页面一起跟着一个计时器在重新渲染，在这个例子里，也就是计算质数的函数不停的在计算，如果用户给了一个很大的数字，就需要for循环每次渲染都去遍历这么大的数字，这是非常浪费性能的一件事。</p>
<p><a href="%E8%BF%99%E9%87%8C%E6%9C%89%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98%EF%BC%8C%E5%B0%B1%E6%98%AF%E6%88%91%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8Context%EF%BC%8C%E6%88%96%E8%80%85Zustand%E7%AD%89%E7%AD%89%E8%83%BD%E6%83%B3%E7%9A%84%E5%88%B0%E7%9A%84%E5%85%B1%E4%BA%AB%E7%8A%B6%E6%80%81%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%88%96%E8%80%85%E9%87%87%E5%8F%96%E5%90%8C%E7%BA%A7%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82%E7%9A%84%E6%96%B9%E5%BC%8F%E5%8E%BB%E6%8A%8A%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E7%9A%84%E5%86%85%E5%AE%B9%E7%9A%84%E6%94%B9%E5%8F%98%E5%AE%9E%E6%97%B6%E5%9C%B0%E5%93%8D%E5%BA%94%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E8%BF%99%E7%A7%8D%E6%95%88%E6%9E%9C%E3%80%82">^1</a>: Javascript 运行时是单线程的，如果我们反复执行这段代码，就会一直有一个计算任务占用着线程。这会导致我们其他任务没法快速执行，整个应用会让人感觉很迟钝，尤其是在低性能的设备上感知更加明显。</p>
<p>那这个时候就需要useMemo来帮我们把计算质数的结果缓存下来：</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> allPrimes = <span class="title class_">React</span>.<span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> counter = <span class="number">2</span>; counter &lt; selectedNum; counter++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isPrime</span>(counter)) &#123;</span><br><span class="line">      result.<span class="title function_">push</span>(counter);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;, [selectedNum]);</span><br></pre></td></tr></table></figure>

<p>这样，只要用户不改变自己输入的数字，这个缓存住的数字就会被react重复调用，以此来对性能进行优化。</p>
<h2 id="1-5最后看一个左脚踩右脚升天"><a href="#1-5最后看一个左脚踩右脚升天" class="headerlink" title="1.5最后看一个左脚踩右脚升天"></a>1.5最后看一个左脚踩右脚升天</h2><p>如果在使用useEffect的时候，调用setState来改变组件的某个状态，然后依赖数组又恰巧是这个state，那很有福了：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 每次 data 改变时都会执行这个 effect</span></span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&quot;https://api.example.com/data&quot;</span>)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 更新状态，导致 data 变化，进而重新执行 effect</span></span><br><span class="line">        <span class="title function_">setData</span>(result);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br><span class="line">  &#125;, [data]); <span class="comment">// 将 data 作为依赖项</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;data ? <span class="tag">&lt;<span class="name">pre</span>&gt;</span>&#123;JSON.stringify(data, null, 2)&#125;<span class="tag">&lt;/<span class="name">pre</span>&gt;</span> : &quot;加载中...&quot;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyComponent</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样就会导致无限请求。🤣🤣🤣</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/22/%E7%94%A8dify%E5%92%8Ccursor%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAai%E6%99%BA%E8%83%BD%E7%BF%BB%E8%AF%91%E5%8A%A9%E6%89%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/22/%E7%94%A8dify%E5%92%8Ccursor%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAai%E6%99%BA%E8%83%BD%E7%BF%BB%E8%AF%91%E5%8A%A9%E6%89%8B/" class="post-title-link" itemprop="url">用dify和cursor构建一个ai智能翻译助手</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-04-22 12:45:05 / Modified: 16:30:59" itemprop="dateCreated datePublished" datetime="2025-04-22T12:45:05+08:00">2025-04-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用Dify低代码平台和cursor来实现零代码基础的ai翻译助手"><a href="#使用Dify低代码平台和cursor来实现零代码基础的ai翻译助手" class="headerlink" title="使用Dify低代码平台和cursor来实现零代码基础的ai翻译助手"></a>使用Dify低代码平台和cursor来实现零代码基础的ai翻译助手</h1><h2 id="1-前提条件准备："><a href="#1-前提条件准备：" class="headerlink" title="1. 前提条件准备："></a>1. 前提条件准备：</h2><h5 id="1-1-首先我们需要有一个谷歌的账号❤，用谷歌的账号我们在使用-Dify-和-cursor-的时候可以做到账号层面的畅通无阻，备选方案是使用-GitHub-账号，如果这两个都没有可以注册一个-GitHub-账号，注册-GitHub-相对来说是更容易的。最后的方案是找助教用助教的账号完成实验。"><a href="#1-1-首先我们需要有一个谷歌的账号❤，用谷歌的账号我们在使用-Dify-和-cursor-的时候可以做到账号层面的畅通无阻，备选方案是使用-GitHub-账号，如果这两个都没有可以注册一个-GitHub-账号，注册-GitHub-相对来说是更容易的。最后的方案是找助教用助教的账号完成实验。" class="headerlink" title="1.1 首先我们需要有一个谷歌的账号❤，用谷歌的账号我们在使用 Dify 和 cursor 的时候可以做到账号层面的畅通无阻，备选方案是使用 GitHub 账号，如果这两个都没有可以注册一个 GitHub 账号，注册 GitHub 相对来说是更容易的。最后的方案是找助教用助教的账号完成实验。"></a>1.1 首先我们需要有一个谷歌的账号❤，用谷歌的账号我们在使用 Dify 和 cursor 的时候可以做到账号层面的畅通无阻，备选方案是使用 GitHub 账号，如果这两个都没有可以注册一个 GitHub 账号，注册 GitHub 相对来说是更容易的。最后的方案是找助教用助教的账号完成实验。</h5><h5 id="1-2-我们要在-Mac-电脑上安装-Google-浏览器，Mac-原来带着的-Safari-浏览器有个弊端就是打不开-Dify-平台中的工作流（也就是我们要通过流程图来实现低代码搭建智能体的页面），没有这个页面我们是无法进行的，如果在-Safari-上能打开-Dify-上的工作流也可以直接使用-Safari。（关于如何安装-Google-浏览器：好像在-Safari-搜索-www-google-不行，得搜索-www-chrome-才能找到下载链接）"><a href="#1-2-我们要在-Mac-电脑上安装-Google-浏览器，Mac-原来带着的-Safari-浏览器有个弊端就是打不开-Dify-平台中的工作流（也就是我们要通过流程图来实现低代码搭建智能体的页面），没有这个页面我们是无法进行的，如果在-Safari-上能打开-Dify-上的工作流也可以直接使用-Safari。（关于如何安装-Google-浏览器：好像在-Safari-搜索-www-google-不行，得搜索-www-chrome-才能找到下载链接）" class="headerlink" title="1.2 我们要在 Mac 电脑上安装 Google 浏览器，Mac 原来带着的 Safari 浏览器有个弊端就是打不开 Dify 平台中的工作流（也就是我们要通过流程图来实现低代码搭建智能体的页面），没有这个页面我们是无法进行的，如果在 Safari 上能打开 Dify 上的工作流也可以直接使用 Safari。（关于如何安装 Google 浏览器：好像在 Safari 搜索 www.google 不行，得搜索 www.chrome 才能找到下载链接）"></a>1.2 我们要在 Mac 电脑上安装 Google 浏览器，Mac 原来带着的 Safari 浏览器有个弊端就是打不开 Dify 平台中的工作流（也就是我们要通过流程图来实现低代码搭建智能体的页面），没有这个页面我们是无法进行的，如果在 Safari 上能打开 Dify 上的工作流也可以直接使用 Safari。（关于如何安装 Google 浏览器：好像在 Safari 搜索 <a target="_blank" rel="noopener" href="http://www.google/">www.google</a> 不行，得搜索 <a target="_blank" rel="noopener" href="http://www.chrome/">www.chrome</a> 才能找到下载链接）</h5><h5 id="1-3-我们需要在浏览器上搜索-cursor，用于生成实验中需要的前端代码，下载好-cursor-后我们还是需要用-Google-或-GitHub-账号来登录，不然没办法使用-AI-生成代码的功能。"><a href="#1-3-我们需要在浏览器上搜索-cursor，用于生成实验中需要的前端代码，下载好-cursor-后我们还是需要用-Google-或-GitHub-账号来登录，不然没办法使用-AI-生成代码的功能。" class="headerlink" title="1.3 我们需要在浏览器上搜索 cursor，用于生成实验中需要的前端代码，下载好 cursor 后我们还是需要用 Google 或 GitHub 账号来登录，不然没办法使用 AI 生成代码的功能。"></a>1.3 我们需要在浏览器上搜索 cursor，用于生成实验中需要的前端代码，下载好 cursor 后我们还是需要用 Google 或 GitHub 账号来登录，不然没办法使用 AI 生成代码的功能。</h5><h2 id="2-正式开始构建我们的-AI-翻译助手"><a href="#2-正式开始构建我们的-AI-翻译助手" class="headerlink" title="2. 正式开始构建我们的 AI 翻译助手"></a>2. 正式开始构建我们的 AI 翻译助手</h2><h5 id="2-1-Dify-创建项目：在-Google-浏览器上搜索-Dify，找到能够使用的链接，进入后会要求我们用-GitHub-或-Chrome-账号来注册或登录，然后我们注册好后先用两分钟左右的时间熟悉一下页面，然后点击「空白引用」，就可以看到一个让我们选择应用类型的页面，给自己的项目自定义一个名字，然后点击「创建工作流」，工作流的初始模板就会出现在页面上。"><a href="#2-1-Dify-创建项目：在-Google-浏览器上搜索-Dify，找到能够使用的链接，进入后会要求我们用-GitHub-或-Chrome-账号来注册或登录，然后我们注册好后先用两分钟左右的时间熟悉一下页面，然后点击「空白引用」，就可以看到一个让我们选择应用类型的页面，给自己的项目自定义一个名字，然后点击「创建工作流」，工作流的初始模板就会出现在页面上。" class="headerlink" title="2.1 Dify 创建项目：在 Google 浏览器上搜索 Dify，找到能够使用的链接，进入后会要求我们用 GitHub 或 Chrome 账号来注册或登录，然后我们注册好后先用两分钟左右的时间熟悉一下页面，然后点击「空白引用」，就可以看到一个让我们选择应用类型的页面，给自己的项目自定义一个名字，然后点击「创建工作流」，工作流的初始模板就会出现在页面上。"></a>2.1 Dify 创建项目：在 Google 浏览器上搜索 Dify，找到能够使用的链接，进入后会要求我们用 GitHub 或 Chrome 账号来注册或登录，然后我们注册好后先用两分钟左右的时间熟悉一下页面，然后点击「空白引用」，就可以看到一个让我们选择应用类型的页面，给自己的项目自定义一个名字，然后点击「创建工作流」，工作流的初始模板就会出现在页面上。</h5><h5 id="2-2-Dify-准备构建项目：点击上方「插件」，然后点击「Marketplace」，在插件市场中搜索我们需要的大模型，这里推荐使用「硅基流动」（因为测试通过）。在搜索框中输入-g-即可看到「硅基流动」，点击安装。可能会提醒你配置-API-Key，点击配置页面会有获取-API-Key-的入口，获取密钥后复制到配置区域，这样模型插件就能使用了。"><a href="#2-2-Dify-准备构建项目：点击上方「插件」，然后点击「Marketplace」，在插件市场中搜索我们需要的大模型，这里推荐使用「硅基流动」（因为测试通过）。在搜索框中输入-g-即可看到「硅基流动」，点击安装。可能会提醒你配置-API-Key，点击配置页面会有获取-API-Key-的入口，获取密钥后复制到配置区域，这样模型插件就能使用了。" class="headerlink" title="2.2 Dify 准备构建项目：点击上方「插件」，然后点击「Marketplace」，在插件市场中搜索我们需要的大模型，这里推荐使用「硅基流动」（因为测试通过）。在搜索框中输入 g 即可看到「硅基流动」，点击安装。可能会提醒你配置 API Key，点击配置页面会有获取 API Key 的入口，获取密钥后复制到配置区域，这样模型插件就能使用了。"></a>2.2 Dify 准备构建项目：点击上方「插件」，然后点击「Marketplace」，在插件市场中搜索我们需要的大模型，这里推荐使用「硅基流动」（因为测试通过）。在搜索框中输入 <code>g</code> 即可看到「硅基流动」，点击安装。可能会提醒你配置 API Key，点击配置页面会有获取 API Key 的入口，获取密钥后复制到配置区域，这样模型插件就能使用了。</h5><h5 id="2-3-Dify-开始构建项目（最难的一步）："><a href="#2-3-Dify-开始构建项目（最难的一步）：" class="headerlink" title="2.3 Dify 开始构建项目（最难的一步）："></a>2.3 Dify 开始构建项目（最难的一步）：</h5><ul>
<li><p><strong>a.</strong> 在「开始」模块上添加输入字段：type、mode、textInput、outputLang、inputLang、file（file 中需选择前两个支持的文件类型）。其中 <code>mode</code>、<code>outputLang</code> 和 <code>inputLang</code> 为必填。</p>
</li>
<li><p><strong>b.</strong> 在「开始」模块下面写一个条件判断：if <code>mode</code> 是 <code>focus</code>，则跑 <code>focus</code> 工作流，else 不需填第二分支。</p>
</li>
<li><p><strong>c1.</strong> 在 else 分支上再添加条件：if <code>type</code> 是 <code>file</code>，先使用「文档提取器」，再调用 LLM；else 直接调用 LLM。在 System 区域输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;角色&gt;</span><br><span class="line">你是一个精通多国语言的翻译官</span><br><span class="line"></span><br><span class="line">&lt;任务&gt;</span><br><span class="line">将用户提供的内容翻译为</span><br><span class="line">用户只提供文本或图片或文件其中一种类型的待翻译内容</span><br><span class="line"></span><br><span class="line">&lt;限制&gt;</span><br><span class="line">不得输出翻译之外的内容</span><br></pre></td></tr></table></figure>

<p>在 User 区域填写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;text_to_translate&gt;&lt;/text_to_translate&gt;</span><br><span class="line">&lt;file_to_translate&gt;&lt;/file_to_translate&gt;</span><br></pre></td></tr></table></figure>

<p>然后选中「视觉」模块，用 <code>&#123;X&#125;</code> 选取「开始」的 <code>file</code> 输出。</p>
</li>
</ul>


##### 这里的{{}}包住的内容需要点击{x}按钮，在我们前面存贮的变量里获取过来，然后这里下一个节点就可以结束了，fast 模式下只用进行一次大模型的思考，结束中的字段是 LLM 的 text，变量名用 textOutput，上面说的这些变量名要重点注意！！！后面前端页面想要使用要和这些变量名对应上才能正确地实现前后端的对接。



<ul>
<li><strong>c2.</strong> 构建 <code>focus</code> 模式下的工作流：打开 YAML 文件，复制内容，在 Dify 中点击「导入 DSL 文件」，选择该文件。大模型插件同样使用「硅基流动」，后续三个翻译 LLM 统一使用 <code>2.5-72B-Instruct</code> 模型（测试通过）。在结束节点中获取意译后的 text，变量名与 fast 模式保持一致。</li>
</ul>
<h5 id="2-4-测试工作流：在-Dify-平台上运行测试，确认所有流程均可正常运行，后端服务部分完成。"><a href="#2-4-测试工作流：在-Dify-平台上运行测试，确认所有流程均可正常运行，后端服务部分完成。" class="headerlink" title="2.4 测试工作流：在 Dify 平台上运行测试，确认所有流程均可正常运行，后端服务部分完成。"></a>2.4 测试工作流：在 Dify 平台上运行测试，确认所有流程均可正常运行，后端服务部分完成。</h5><h5 id="2-5-调用-Dify-API：点击「访问-API」，获取应用的-API-Key，以及-Base-URL。完整接口为："><a href="#2-5-调用-Dify-API：点击「访问-API」，获取应用的-API-Key，以及-Base-URL。完整接口为：" class="headerlink" title="2.5 调用 Dify API：点击「访问 API」，获取应用的 API Key，以及 Base URL。完整接口为："></a>2.5 调用 Dify API：点击「访问 API」，获取应用的 API Key，以及 Base URL。完整接口为：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;baseUrl&gt;/workflows/run</span><br></pre></td></tr></table></figure>

<h2 id="3-使用-cursor-创建前端页面"><a href="#3-使用-cursor-创建前端页面" class="headerlink" title="3. 使用 cursor 创建前端页面"></a>3. 使用 cursor 创建前端页面</h2><h5 id="3-1-安装-Homebrew（macOS）："><a href="#3-1-安装-Homebrew（macOS）：" class="headerlink" title="3.1 安装 Homebrew（macOS）："></a>3.1 安装 Homebrew（macOS）：</h5><ol>
<li><p>打开「终端」</p>
</li>
<li><p>输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>根据提示执行 <code>echo</code> 命令，将 Homebrew 添加到 shell 配置中。</p>
</li>
<li><p>验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew --version</span><br></pre></td></tr></table></figure></li>
</ol>
<p>安装成功后，可以使用 Homebrew 安装 node：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>

<h5 id="3-2-使用-cursor-AI-编程助手："><a href="#3-2-使用-cursor-AI-编程助手：" class="headerlink" title="3.2 使用 cursor AI 编程助手："></a>3.2 使用 cursor AI 编程助手：</h5><ul>
<li>执行 <code>npm install</code> 安装项目依赖。</li>
<li>使用 <code>cmd+i</code> 唤起 cursor，将本文件内容复制粘贴，修正 <code>foucs</code> 为 <code>focus</code> 拼写错误。</li>
<li>让 AI 生成前端翻译页面的初稿，后续根据实际 API 响应格式和样式微调。</li>
<li>将提示词中的 API Key 替换为自己在 Dify 中生成的 Key，前端接口统一调用无需修改。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/12/let%E5%92%8Cvar%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8C%BA%E5%88%AB%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/12/let%E5%92%8Cvar%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8C%BA%E5%88%AB%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/" class="post-title-link" itemprop="url">let和var的一些区别（持续更新）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-12 12:46:06" itemprop="dateCreated datePublished" datetime="2025-04-12T12:46:06+08:00">2025-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-22 20:30:43" itemprop="dateModified" datetime="2025-04-22T20:30:43+08:00">2025-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-Let-Var的区别"><a href="#1-Let-Var的区别" class="headerlink" title="1.Let Var的区别"></a>1.Let Var的区别</h1><h2 id="1-1let-和var在for循环中的区别："><a href="#1-1let-和var在for循环中的区别：" class="headerlink" title="1.1let 和var在for循环中的区别："></a>1.1let 和var在for循环中的区别：</h2><p>​        这是mini群里单老师的面试题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(i), <span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​       问题是这个循环在终端会打印出什么，我的第一想法是012，但是既然出到面试了肯定不一样又觉得是222，觉得222的理由是从宏任务和微任务的角度出发的。本人看宏任务和微任务已经魔怔了，现在看到Promise和setTimeOut就会应激捏🤣🤣🤣。</p>
<p>​        我从宏任务和微任务的角度去思考的时候整个逻辑是这样想的：i通过循环已经变成了2（其实这么想已经错了哈，i到3的时候这个循环才会结束（怎么会犯这么蠢的错误😢😢😢）），此时才会去执行setTimeout这个宏任务去。</p>
<p>​        但是这么想一半是错误的，这里确实有setTimeOut的宏任务的因素导致，但是最主要的因素还是出在var这个变量声明的逻辑。在使用var声明变量的时候，声明出的变量是在整个函数的范围内共享的，并不会因为for循环而去产生新的变量，就是说，声明的i变量会执行这样的操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i=0;</span><br><span class="line">i=1;</span><br><span class="line">i=2;</span><br><span class="line">i=3;</span><br></pre></td></tr></table></figure>

<p>​         此时每个等待中的setTimeout去执行的时候把i放进自己的console中去，就打印了四个3；</p>
<p>​         怎么可以解决这个问题呢？</p>
<p>​         有两个方案，一个是单老师在群里说的var换成let，用let声明为循环中的每个i制造一个块级作用域，这样的话setTimeout进入排队队列的时候就是带着属于自己的“身份”进去的。流程就变成了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i=0;</span><br><span class="line">setTimeOut(...console.log(i))</span><br><span class="line">i=1;</span><br><span class="line">setTimeOut(...console.log(i))</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>​          这样就可以让这个for循环打印出想要的结果。</p>
<p>​          第二个方案是使用立即执行函数强行创造一个新的作用域，让setTiemOut捕获到的值是立即执行函数的值。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/01/Ts%E7%9A%84%E4%B8%80%E7%82%B9%E7%82%B9%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/01/Ts%E7%9A%84%E4%B8%80%E7%82%B9%E7%82%B9%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">Ts的一点点介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-01 12:47:35" itemprop="dateCreated datePublished" datetime="2025-04-01T12:47:35+08:00">2025-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-22 20:30:57" itemprop="dateModified" datetime="2025-04-22T20:30:57+08:00">2025-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="本周分享"><a href="#本周分享" class="headerlink" title="本周分享"></a>本周分享</h1><h2 id="1-说点硬写Typescript的感悟吧"><a href="#1-说点硬写Typescript的感悟吧" class="headerlink" title="1.说点硬写Typescript的感悟吧"></a>1.说点硬写Typescript的感悟吧</h2><h3 id="1-1先说点废话"><a href="#1-1先说点废话" class="headerlink" title="1.1先说点废话"></a>1.1先说点废话</h3><p>TypeScript是JavaScript的超集，也就是说ts吸收了js的特性，拥有js语言的所有功能，并在这些特性的基础上加以强化和扩展，也就是说ts是一个在js的基础上做了扩展的语言，拥有包含js所有功能并增加更多特性的语言。</p>
<ol>
<li>Ts包含所有有效的Js代码，任何合法的Js代码也是有效的Ts代码，甚至可以在Ts中直接运行（gpt说的），实际上写功能的时候很多js的代码很难在Ts里跑，不过我现阶段经常干的一件事情就是把自己写的Js代码一大坨一大坨地给Gpt然后让它给我转换成Ts代码，在实际操作上，gpt表现地很好，一般我自己写的代码没问题的情况下它能给我对应地生成相应的正确的Ts代码（但是我目前写的js代码量还有点小，gpt可以很轻松高效率地转换可能是因为这个，后续写mini的时候试试把更大坨的Js代码给它试试），这点很大减轻了我写tsx的压力。</li>
<li>Ts扩展了Js，在Js的基础上，Ts引入了静态类型系统（我可以说变成了带着c语言味道的Js吗）需要写类型注解并可以进行类型推导。引入类、接口、泛型等等高级特性。这会使得它相对于Js爆错更多（这个我是真体会到了），但是会让整个代码的可维护性和可读性加强。</li>
</ol>
<h3 id="1-2Ts的扩展"><a href="#1-2Ts的扩展" class="headerlink" title="1.2Ts的扩展"></a>1.2Ts的扩展</h3><ol>
<li><p>类型系统：引入类型声明</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">name</span>:<span class="built_in">string</span>=<span class="string">&quot;Alice&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">age</span>:<span class="built_in">number</span>=<span class="number">25</span>;</span><br></pre></td></tr></table></figure>

<p>并支持复杂的类型（如联合类型<code>|</code>交叉类型<code>&amp;</code>这些等等</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [activeButton, setActiveButton] = useState&lt;<span class="built_in">string</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<p><code>|</code>允许你的值可以是多个类型，比如这个activeButton就可以是null，也可以是string</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Address</span> &#123;</span><br><span class="line">  <span class="attr">street</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">city</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PersonWithAddress</span> = <span class="title class_">Person</span> &amp; <span class="title class_">Address</span>; </span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>: <span class="title class_">PersonWithAddress</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">street</span>: <span class="string">&quot;123 Main St&quot;</span>,</span><br><span class="line">  <span class="attr">city</span>: <span class="string">&quot;Wonderland&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>&amp;</code>允许将多个类型合并为一个类型，它通过<code>&amp;</code>来连接不同的类型，当你希望某个变量同时具备多个类型的特性的时候，可以使用交叉类型。</p>
</li>
<li><p>引入接口，使得代码更加面向对象。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> <span class="attr">name</span>: <span class="built_in">string</span>, <span class="keyword">public</span> <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接口在Ts中用于定义对象的结构或契约的工具，它指定了对象应该有那些属性和方法，但不提供实现的细节，接口只关注“形状”而不关心具体的实现</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">user</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接口还可以定义函数的类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Greet</span> &#123;</span><br><span class="line">  (<span class="attr">message</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">greet</span>: <span class="title class_">Greet</span> = <span class="function">(<span class="params"><span class="attr">message</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&quot;Hello, TypeScript!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>在这个例子里Greet定义了一个函数的类型，要求它的实例是一个接受string类型的参数并返回void的函数。</p>
<p>然后还有接口的继承，但是我现在还没太用到，我也不是很懂。</p>
<p>3.泛型，Ts支持泛型，这使得开发者可以编写更加灵活、通用和可复用性强的代码。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="title function_">identity</span>(<span class="number">5</span>);        <span class="comment">// T 被推导为 number</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="title function_">identity</span>(<span class="string">&quot;Hello&quot;</span>);  <span class="comment">// T 被推导为 string</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个函数使用了泛型参数<T>,表示该函数可以接受任何类型的参数，并且返回相同类型的结果。</p>
<p><T>定义了这个函数是个泛型函数，（arg:T)定义了这个函数接受的参数可以是任何类型。：后面的那个T说明了这个函数返回的类型应该与传入的参数是一直的。</p>
<p>4.类型推导，Ts可以自动推导变量的类型，减少开发者的手动声明。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">10</span>;<span class="comment">//ts自动推导这个x的类型为number</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;hello&quot;</span>;  <span class="comment">// TypeScript 推导 str 的类型是 string</span></span><br><span class="line"><span class="keyword">let</span> isActive = <span class="literal">true</span>;  <span class="comment">// TypeScript 推导 isActive 的类型是 boolean</span></span><br></pre></td></tr></table></figure>

<p>还有很多的类型推导，比如自动推导这个数组是以什么数据类型构成的数组，自动推导函数返回值不用额外声明。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"><span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;  <span class="comment">// TypeScript 推导返回值的类型是 number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>;  <span class="comment">// TypeScript 推导返回值的类型是 string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看ts看到类型推导的时候感觉和Js里的隐式转换很像，就去搜了下这和Js里的隐式转换有什么区别。</p>
<p>隐式转换是Js中的一种行为，当操作的类型不匹配的时候，Js会尝试将他们转换成兼容的类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;10&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = num + str;  <span class="comment">// 隐式转换，结果是字符串 &quot;510&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);  <span class="comment">// 输出 &quot;510&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个例子中5被自动自动转换成了字符串，这个加法操作就变成了连接操作。</p>
<p>类型推导和隐式转换有着本质的不同，类型推导发生在编译时，它并不会去改变值得实际类型，而是推断出合适的类型，并用来进行类型检查。而隐式转换发生在运行时，实际值的类型发生了转换，转换成了另一种类型。</p>
<p>这个不同就让类型推导是Ts里的一个优良的特性，让Ts的代码在运行的时候可以避免一些错误。而隐式转换让代码更简洁的同时会产生很多的错误和问题，而且这些问题通常是难以追踪的。隐式转换之所以叫隐式转换，我想原因应该是开发者无法显式地发现这些类型变化。</p>
<h2 id="2-Js的隐式转换"><a href="#2-Js的隐式转换" class="headerlink" title="2.Js的隐式转换"></a>2.Js的隐式转换</h2><h3 id="2-1可能导致的安全问题"><a href="#2-1可能导致的安全问题" class="headerlink" title="2.1可能导致的安全问题"></a>2.1可能导致的安全问题</h3><p>Js的隐式转换通常会产生很多的问题，无法显式地看到转换导致很多难以追踪地错误。</p>
<p>在+<code>、</code>-<code>、``==</code>这些操作时，隐式转换很可能发生以至于产生很多麻烦，比如使用<code>==</code>的时候经常会发生一些莫名奇妙的true，比如Js中把这个null和undefined在进行<code>==</code>操作的时候会出现true。然后0和false也是被认为是相等的。</p>
<p>就比如</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (userInput == <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// 用户输入为空字符串、0 或 false 会导致这个条件为 true</span></span><br><span class="line">  <span class="comment">// 导致错误的逻辑执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个地方用<code>==</code>就不够安全，userInput的值可以为0，false和空字符串，这都会让这个<code>==</code>成立。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">userInput</span>: <span class="built_in">string</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (userInput == <span class="number">0</span>) &#123;  <span class="comment">// TS 会报错：类型 &#x27;string&#x27; 和 &#x27;number&#x27; 不兼容</span></span><br><span class="line">  <span class="comment">// 不会执行此代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在Ts里通过强制的类型检查就让这种情况发生的可能性大大降低。然后其实用<code>===</code>这种严格的相等也可以解决这个问题。</p>
<h3 id="2-2性能问题"><a href="#2-2性能问题" class="headerlink" title="2.2性能问题"></a>2.2性能问题</h3><p>虽然隐式转换的性能问题通常不显著，但在一些性能关键的应用中（如循环内的转换或大量数据的处理），隐式转换可能会增加额外的计算负担。尤其是在进行类型转换的逻辑不明确或难以追踪时，可能增加调试成本，导致代码运行效率低下。</p>
<h3 id="2-3隐式转换带来的一些好处"><a href="#2-3隐式转换带来的一些好处" class="headerlink" title="2.3隐式转换带来的一些好处"></a>2.3隐式转换带来的一些好处</h3><p>隐式转换也有其优势，首先提高了代码的简洁性，少了很多显示的类型转换，不需要进行频繁的显式的转换。其次，这也提高了灵活性和宽容性，在处理不同类型的数据时可以更加宽容和灵活。</p>
<h3 id="2-4隐式转换是创作者BE有意而为之还是他写得太快搞出来的小bug"><a href="#2-4隐式转换是创作者BE有意而为之还是他写得太快搞出来的小bug" class="headerlink" title="2.4隐式转换是创作者BE有意而为之还是他写得太快搞出来的小bug"></a>2.4隐式转换是创作者BE有意而为之还是他写得太快搞出来的小bug</h3><p>Js的创始人 <strong>Brendan Eich</strong> 本意是设计一个简单易用的脚本语言，能够快速把网页的交互功能实现，减少代码工作者的代码量。</p>
<p>就比如<code>==</code>这个运算符在Js里可以实现不同类型的数据类型进行比较。我想他本人可能有意设计了隐式转换，没想到后面Js会更加考虑安全性和可维护性让隐式转换更多成了一种弊端。什么<code>null</code>等于<code>undefined</code>被认为是可行的，还有上面说的自动类型转换让开发者难以发觉这种类似的问题，实际上刚出现的时候作者不是想这么干，我想他那么牛，开发java又开发js的应该不会让这么不严谨的东西存在在自己的语言里。可以说，隐式转换是<strong>有意设计的特性</strong>，但它带来的副作用并不是开发者预期中的行为。随着开发经验的积累和语言的演变，隐式转换带来的问题逐渐被认识到并加以改进（例如 TypeScript 的出现、<code>strict mode</code>、以及对更严格的类型检查的推动）。</p>
<p>用Ts这类的强类型语言来增强代码的安全性，用严格模式来禁用某些错误的Js特性来确保代码更加安全。</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/01/%E5%8E%9F%E5%9E%8B%E9%93%BE%E5%92%8Cthis%E6%8C%87%E5%90%91%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/11/01/%E5%8E%9F%E5%9E%8B%E9%93%BE%E5%92%8Cthis%E6%8C%87%E5%90%91%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/" class="post-title-link" itemprop="url">原型链和this指向的简单理解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-01 19:52:59" itemprop="dateCreated datePublished" datetime="2024-11-01T19:52:59+08:00">2024-11-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-22 12:40:53" itemprop="dateModified" datetime="2025-04-22T12:40:53+08:00">2025-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="分享"><a href="#分享" class="headerlink" title="分享"></a>分享</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h3 id="因为一些地方学习不到位的原因，我在这个实习期间学习js碰到了很多问题，然后这一周本来想把这些都补补，但无奈和这个辩论队的任务重合，让我这个又准备不好辩论内容，又没时间把js上的问题逐一解决，只好用仅剩的时间从一开始的问题入手，把后面一些没有学扎实的内容它们的学习分到了下周去，然后分享的话就把这个最初遇到的原型链的问题和this指向的问题说说。"><a href="#因为一些地方学习不到位的原因，我在这个实习期间学习js碰到了很多问题，然后这一周本来想把这些都补补，但无奈和这个辩论队的任务重合，让我这个又准备不好辩论内容，又没时间把js上的问题逐一解决，只好用仅剩的时间从一开始的问题入手，把后面一些没有学扎实的内容它们的学习分到了下周去，然后分享的话就把这个最初遇到的原型链的问题和this指向的问题说说。" class="headerlink" title="因为一些地方学习不到位的原因，我在这个实习期间学习js碰到了很多问题，然后这一周本来想把这些都补补，但无奈和这个辩论队的任务重合，让我这个又准备不好辩论内容，又没时间把js上的问题逐一解决，只好用仅剩的时间从一开始的问题入手，把后面一些没有学扎实的内容它们的学习分到了下周去，然后分享的话就把这个最初遇到的原型链的问题和this指向的问题说说。"></a>因为一些地方学习不到位的原因，我在这个实习期间学习js碰到了很多问题，然后这一周本来想把这些都补补，但无奈和这个辩论队的任务重合，让我这个又准备不好辩论内容，又没时间把js上的问题逐一解决，只好用仅剩的时间从一开始的问题入手，把后面一些没有学扎实的内容它们的学习分到了下周去，然后分享的话就把这个最初遇到的原型链的问题和this指向的问题说说。</h3><h2 id="java-script中的几条链和this指向"><a href="#java-script中的几条链和this指向" class="headerlink" title="java script中的几条链和this指向"></a>java script中的几条链和this指向</h2><h2 id="1-js中的原型链"><a href="#1-js中的原型链" class="headerlink" title="1.js中的原型链"></a>1.js中的原型链</h2><p>js中对象这种引用数据类型十分常用，并且在面向对象编程时往往发挥关键作用。js可以进行面向过程的编程和面向对象编程的语言，其中js面向对象编程通过原型来实现。</p>
<p>构造函数时，实例化的成员会携带一个proto指向构造出的函数的原型对象，也就是指向了它的“父亲”的原型对象，它的父亲的原型对象，也有一个proto指向了Object的原型对象，然后Object的原型对象里也有一个proto指向了null，这个是原型链。</p>
<p>原型和原型链的意义是：使得 JavaScript 可以实现继承和代码复用。通过原型继承，可以从已有的对象创建新的对象，并且可以在新对象上添加、修改或删除属性和方法，达到代码复用和扩展的目的。原型链则使得 JavaScript 中的对象可以通过原型链向上查找属性和方法，这样就可以实现属性和方法的继承，减少重复代码的编写。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/11/01/%E5%8E%9F%E5%9E%8B%E9%93%BE%E5%92%8Cthis%E6%8C%87%E5%90%91%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/01/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/11/01/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-01 18:39:49" itemprop="dateCreated datePublished" datetime="2024-11-01T18:39:49+08:00">2024-11-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
